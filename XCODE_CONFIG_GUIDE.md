# Xcode é…ç½®æˆªå›¾æŒ‡å—

## å¿«é€Ÿé…ç½®ï¼ˆ5åˆ†é’Ÿï¼‰

### ç¬¬ä¸€æ­¥ï¼šæ‰“å¼€é¡¹ç›®è®¾ç½®

```
Xcode â†’ é¡¹ç›®å¯¼èˆªå™¨ï¼ˆå·¦ä¾§ï¼‰ â†’ ç‚¹å‡»è“è‰²é¡¹ç›®å›¾æ ‡ â†’ é€‰æ‹© easyView target
```

### ç¬¬äºŒæ­¥ï¼šSigning & Capabilities

åœ¨é¡¶éƒ¨æ ‡ç­¾æ æ‰¾åˆ° "Signing & Capabilities"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ General â”‚ Signing & Capabilities â”‚ ... â”‚  â† ç‚¹å‡»è¿™é‡Œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ  App Sandbox

ç‚¹å‡» "+ Capability" æŒ‰é’®ï¼ˆé€šå¸¸åœ¨å·¦ä¸Šè§’ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ + Capability     â”‚  â† ç‚¹å‡»è¿™é‡Œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœç´¢å¹¶åŒå‡»ï¼šApp Sandbox
```

### ç¬¬å››æ­¥ï¼šé…ç½®æ–‡ä»¶è®¿é—®æƒé™ï¼ˆåŠ¨æ€æƒé™ï¼‰

åœ¨ App Sandbox åŒºåŸŸï¼Œæ‰¾åˆ° "File Access" éƒ¨åˆ†ï¼š

```
App Sandbox
â”œâ”€â”€ Network
â”œâ”€â”€ Hardware
â”œâ”€â”€ App Data
â””â”€â”€ File Access â† åœ¨è¿™é‡Œé…ç½®
    â”œâ”€â”€ â˜‘ User Selected File (Read Only)      â† åªéœ€å‹¾é€‰è¿™ä¸€ä¸ªï¼
    â”œâ”€â”€ â˜ Downloads Folder (ä¸éœ€è¦)
    â”œâ”€â”€ â˜ Pictures Folder (ä¸éœ€è¦)
    â””â”€â”€ â˜ Music Folder (ä¸éœ€è¦)
```

â­ **é‡è¦**ï¼šåªéœ€è¦å‹¾é€‰ "User Selected File"ï¼
- è¿™æ˜¯**åŠ¨æ€æƒé™**ï¼Œç”¨æˆ·é€‰æ‹©ä»€ä¹ˆå°±èƒ½è®¿é—®ä»€ä¹ˆ
- ä¸é™äºç‰¹å®šæ–‡ä»¶å¤¹ï¼Œå¯ä»¥è®¿é—®ä»»æ„ä½ç½®
- ä¸éœ€è¦å›ºå®šçš„ Downloadsã€Pictures ç­‰æƒé™

### ç¬¬äº”æ­¥ï¼šè®¾ç½® Entitlements æ–‡ä»¶

åœ¨ "Signing & Capabilities" æ ‡ç­¾ä¸‹ï¼Œæ‰¾åˆ°ï¼š

```
Code Signing Entitlements: [è¾“å…¥æ¡†]
```

è¾“å…¥æˆ–é€‰æ‹©ï¼š`easyView/easyView.entitlements`

### ç¬¬å…­æ­¥ï¼šéªŒè¯é…ç½®

ç‚¹å‡» "Build Settings" æ ‡ç­¾ï¼Œæœç´¢ "entitlements"ï¼š

```
Code Signing Entitlements
  Debug:   easyView/easyView.entitlements
  Release: easyView/easyView.entitlements
```

### ç¬¬ä¸ƒæ­¥ï¼šClean & Build

```
èœå•æ  â†’ Product â†’ Clean Build Folder (â‡§âŒ˜K)
èœå•æ  â†’ Product â†’ Build (âŒ˜B)
èœå•æ  â†’ Product â†’ Run (âŒ˜R)
```

## éªŒè¯æˆåŠŸ

è¿è¡Œåº”ç”¨åï¼Œæ‰“å¼€ Downloads ä¸­çš„å›¾ç‰‡ï¼š

âœ… **æˆåŠŸæ ‡å¿—**ï¼š
```
ğŸ” ç”¨æˆ·é€‰æ‹©äº† 1 ä¸ªé¡¹ç›®
  å¤„ç†: photo.jpg (isDirectory: false)
  ğŸ” æ‰«æçˆ¶æ–‡ä»¶å¤¹: Downloads
  ğŸ” æ‰«æç›®å½•: /Users/.../Downloads
  ğŸ“‚ æ‰¾åˆ° 25 ä¸ªé¡¹ç›®
    âœ“ photo1.jpg
    âœ“ photo2.jpg
    ...
  âœ… æ‰¾åˆ° 10 å¼ å›¾ç‰‡
```

âŒ **å¤±è´¥æ ‡å¿—**ï¼ˆéœ€è¦æ£€æŸ¥é…ç½®ï¼‰ï¼š
```
âŒ è¯»å–ç›®å½•å¤±è´¥: The file "Downloads" couldn't be opened because you don't have permission
```

## æ•…éšœæ’é™¤

### é—®é¢˜ 1ï¼šæ‰¾ä¸åˆ° "+ Capability" æŒ‰é’®
- ç¡®ä¿ä½ é€‰æ‹©çš„æ˜¯ **target**ï¼ˆeasyViewï¼‰ï¼Œä¸æ˜¯é¡¹ç›®
- ç¡®ä¿ä½ åœ¨ "Signing & Capabilities" æ ‡ç­¾ï¼Œä¸æ˜¯å…¶ä»–æ ‡ç­¾

### é—®é¢˜ 2ï¼šApp Sandbox å·²å­˜åœ¨ä½†æ²¡æœ‰æƒé™é€‰é¡¹
- ç‚¹å‡» App Sandbox æ ‡é¢˜æ å±•å¼€
- å‘ä¸‹æ»šåŠ¨æ‰¾åˆ° "File Access" éƒ¨åˆ†

### é—®é¢˜ 3ï¼šEntitlements æ–‡ä»¶è·¯å¾„æŠ¥é”™
- ç¡®ä¿æ–‡ä»¶ç¡®å®å­˜åœ¨äº `easyView/easyView.entitlements`
- åœ¨ Xcode å·¦ä¾§å¯¼èˆªå™¨ä¸­ç¡®è®¤æ–‡ä»¶å·²æ·»åŠ åˆ°é¡¹ç›®

### é—®é¢˜ 4ï¼šBuild åä»ç„¶æ²¡æœ‰æƒé™
- å®Œå…¨é€€å‡ºåº”ç”¨
- åœ¨ Xcode ä¸­ Clean Build Folder (â‡§âŒ˜K)
- é‡æ–° Build (âŒ˜B) å’Œ Run (âŒ˜R)
- ç¡®ä¿é‡æ–°å®‰è£…äº†åº”ç”¨

### é—®é¢˜ 5ï¼šæƒé™å¯¹è¯æ¡†æ²¡æœ‰å¼¹å‡º
- é¦–æ¬¡è®¿é—®å—ä¿æŠ¤æ–‡ä»¶å¤¹æ—¶æ‰ä¼šå¼¹å‡º
- å¦‚æœä¹‹å‰æ‹’ç»è¿‡ï¼Œéœ€è¦åœ¨ç³»ç»Ÿè®¾ç½®ä¸­æ‰‹åŠ¨æˆæƒ

## å‘½ä»¤è¡ŒéªŒè¯

æ£€æŸ¥ entitlements æ˜¯å¦æ­£ç¡®åº”ç”¨ï¼š

```bash
# æ„å»ºåº”ç”¨å
codesign -d --entitlements - /path/to/easyView.app

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
# <key>com.apple.security.files.user-selected.read-write</key>
# <true/>
# <key>com.apple.security.files.downloads.read-write</key>
# <true/>
```

## ç³»ç»Ÿæƒé™ç®¡ç†

å¦‚æœéœ€è¦é‡ç½®æƒé™ï¼š

```
ç³»ç»Ÿè®¾ç½®
â””â”€â”€ éšç§ä¸å®‰å…¨æ€§
    â””â”€â”€ æ–‡ä»¶å’Œæ–‡ä»¶å¤¹
        â””â”€â”€ EasyView
            â”œâ”€â”€ â˜‘ ä¸‹è½½æ–‡ä»¶å¤¹
            â”œâ”€â”€ â˜‘ å›¾ç‰‡æ–‡ä»¶å¤¹
            â””â”€â”€ â˜‘ æ–‡ç¨¿æ–‡ä»¶å¤¹
```

## å®Œæˆï¼

é…ç½®å®Œæˆåï¼Œåº”ç”¨å°±èƒ½ï¼š
- âœ… æ‰“å¼€å•ä¸ªå›¾ç‰‡æ—¶è‡ªåŠ¨æ‰«ææ•´ä¸ªæ–‡ä»¶å¤¹
- âœ… è®¿é—® Downloadsã€Pictures ç­‰ç³»ç»Ÿæ–‡ä»¶å¤¹
- âœ… æ­£å¸¸ä½¿ç”¨å·¦å³ç®­å¤´æµè§ˆæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰å›¾ç‰‡

äº«å—ä½ çš„å›¾ç‰‡æµè§ˆå™¨å§ï¼ğŸ‰
